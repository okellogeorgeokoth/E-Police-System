!function(){"use strict";function e(e){if("object"!=typeof e)throw new Error("Logger needs options object");if("string"!=typeof e.url)throw new Error("Logger needs url");this._url=e.url,this._cors=!0===e.cors,this._baseLogData={},this._maxNumberOfLogs=1e3,"number"==typeof e.maxNumberOfLogs&&(this._maxNumberOfLogs=e.maxNumberOfLogs),this._numberOfLogsSent=0,"string"==typeof e.extraUid&&this.addLogData("extra_uid",e.extraUid)}var t=function(e){var t=Object.prototype.hasOwnProperty,o=!{toString:null}.propertyIsEnumerable("toString"),r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=r.length;if("function"!=typeof e&&("object"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var i,s,a=[];for(i in e)t.call(e,i)&&a.push(i);if(o)for(s=0;s<n;s++)t.call(e,r[s])&&a.push(r[s]);return a},o=function(e,o){var r=[];r="function"==typeof Object.keys?Object.keys(o):t(o);for(var n=0;n<r.length;n++)e[r[n]]=o[r[n]]},r=function(){return"undefined"!=typeof $&&$.hasOwnProperty("ajax")},n=function(e,t,o){try{r()&&i(e,t,o)}catch(n){}},i=function(e,t,o){var r=0,n={url:e,method:"POST",data:{data:o},xhrFields:{withCredentials:t}},i=function(){$.ajax(n).fail(function(e,t,o){r>=5||(r+=1,setTimeout(function(){i(n)},1e3*r))})};i()},s=function(e){if(void 0===e)return{};if(null===e)return{};var t={};if("undefined"!=typeof e.message&&(t.exception_message=e.message),"undefined"!=typeof e.name&&(t.exception_name=e.name),"undefined"!=typeof e.columnNumber&&(t.exception_column=e.columnNumber),"undefined"!=typeof e.lineNumber&&(t.exception_line=e.lineNumber),"undefined"!=typeof e.fileName&&(t.exception_file=e.fileName),"undefined"!=typeof e.stack){var o="no valid stack info";if("string"==typeof e.stack)o=e.stack;else try{o=JSON.stringify(e.stack)}catch(r){o="failed to create stack: "+r.message}t.exception_stack=o}return t},a=function(e,t,r){"string"!=typeof e&&(e="no valid message in log");var n={message:e};try{if(o(n,t),void 0===r);else if(null===r);else if("string"==typeof r)n.info=r;else if("number"==typeof r)n.info=r.toString();else if(r instanceof Error){var i=s(r);o(n,i)}else"object"==typeof r?o(n,r):n.info=JSON.stringify(r);try{n.page_url=window.location.href}catch(a){}}catch(a){n.info="message: "+e,n.message="exception in logger",n.exception_message=a.message,t.hasOwnProperty("job_id")&&(n.job_id=t.job_id),t.hasOwnProperty("extra_uid")&&(n.extra_uid=t.extra_uid)}return n};e.prototype.parseError=function(e){return s(e)},e.prototype.addLogData=function(e,t){this._baseLogData[e]=t},e.prototype.log=function(e,t,o){if(!(++this._numberOfLogsSent>this._maxNumberOfLogs))try{var r=a(e,this._baseLogData,t);void 0!==o&&(r.level=o),n(this._url,this._cors,r)}catch(i){}},e.prototype.debug=function(e,t){this.log(e,t,100)},e.prototype.info=function(e,t){this.log(e,t,200)},e.prototype.notice=function(e,t){this.log(e,t,250)},e.prototype.warning=function(e,t){this.log(e,t,300)},e.prototype.error=function(e,t){this.log(e,t,400)},e.prototype.critical=function(e,t){this.log(e,t,500)},e.prototype.alert=function(e,t){this.log(e,t,550)},e.prototype.emergency=function(e,t){this.log(e,t,600)};var c=function(e){var t=e;try{if(t=t.toLowerCase(),"script error."===(t=t.trim())||"script error"===t)return!1;if("access is denied."===t||"access is denied"===t)return!1}catch(o){}return!0},f={url:"/api/z",cors:!1,maxNumberOfLogs:500,extraUid:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}()};if("object"==typeof window.qgLoggerOptions){var u=window.qgLoggerOptions;"string"==typeof u.url&&(f.url=u.url),f.cors=!0===u.cors}var p=new e(f);!function(e){var t=window.onerror;window.onerror=function(o,r,n,i,s){try{if(c(o)){var a={};void 0!==s&&null!==s&&(a=e.parseError(s)),a.exception_message=o,void 0!==r&&(a.exception_source=r),void 0!==n&&(a.exception_line=n),void 0!==i&&(a.exception_column=i),e.error("Uncaught JS Exception",a)}}catch(f){e.error("onerror exception",f)}return"function"==typeof t&&t(o,r,n,i,s),!1}}(p),window.qgLogger=p}();